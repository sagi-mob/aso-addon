<!DOCTYPE html>
<html>
<head>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
		<link rel="stylesheet" href="//brick.a.ssl.fastly.net/Roboto:400"/>
        <?!= include("main-css"); ?>
		<base target="_top">
	</head>
	<body>
		<div class="container">
        
			<form class="form-group">
                <fieldset>
                  <legend>Ranges:</legend>
                  <textarea class="form-control" rows="4" cols="50" name="ranges" placeholder="Insert ranges..."></textarea>
                </fieldset>
                
                
				<div class="block" id="button-bar">
                <div style="margin: 3px;">
                <input type="checkbox" name="randomColor" value="Randomize Colors" style="margin: auto 3px auto 0;">Randomize Colors?<br>
                </div>
					<button class="btn btn-default" id="hightlighBtn">Highlight</button>
				</div>
				<h5 class="error" id="error"></h5>
			</form>
            
            <div class="fluid">
                <h3>Basic Instructions</h3>
                <ol>
                <li>Make sure you have one cell and only one, that contains only the phrase 'Description Link'.
                <br>It supposed to have a hyperlink attached to it, that refers to the Description in which we want the keywords to be highlighted.
                <br>Example:
                <img src="https://i.imgur.com/TmEBpkY.png" class="img-fluid" alt="Responsive image">
                </li>
                
                <li>Insert a Ranges list that conatains keywords you wish to highlight.
                <br>Such as: <img src="https://i.imgur.com/70CGuZg.png" class="img-fluid" alt="Responsive image">
                <div class="well well-sm">
                You can choose if you want to highlight keywords in random colors (by clicking the 'Randomize Colors?' checkbox) or in a basic yellow marker color (leave unchecked).
                </div>
                </li>
                </ol>
                
                
           </div>
		</div>
	</body>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<script>
		$(function() {
          $('#hightlighBtn').click(highlight);
		});
		
		/**
		 * Runs a server-side function to translate the text on all slides.
		 */
		
        
        function highlight(){
        google.script.run
		      .withSuccessHandler(handleResponse)
		      .withFailureHandler(handleResponse)
		      .withUserObject(this)
		      .highlighter($('textarea[name=ranges]').val().split(/[\,|\n|\s]+/gm), $('input[type=checkbox]').prop('checked'));
        }
        
        
        
        function handleResponse(msg, element){
        element.disabled = false;
        $('#error').empty()
        .append(msg);
        $('#error').fadeIn().delay(5000).fadeOut();
        }
	</script>
</html>